# Absorption Ratio

This work comes from a Citigroup research *Under the Microscope: Measuring Systemic Risk - The Absorption Ratio*. The idea behind the work is that it measures systematic risk by comparing the proportion of total variability to the variability of $n$ principal components less than the features of the dataset. 

# Data

This repo uses public-facing data from Yahoo Finance for the S&P 500 names from 2000 to 2024. The idea behind this paper is to measure systemic risk using the index constituents individually there are 3 problems sourcing the data within via Yahoo finance. 

1. The data doesn't include index exclusions i.e. survivorship bias.
2. The data doesn't account for historical inclusions it uses all of the availble returns for every name in Sept of 2024 that goes back to 2000.
3. The returns aren't scaled with respect to floating market cap weight. 

The first two problems are somewhat sovable there isn't a public facing dataset or an easy way within Bloomberg Terminal API to get index event inclusions and exclusions. 

The third problem can be solved by using market cap data and re-weighting the index with the same weighting frequency. Historical market cap data isn't available via yahoo finance and not easily available within Bloomberg Terminal API.

Although these cases would be a glaring data sourcing problems when it comes to productionalization there are three reasons why this should be overlooked. 
1. If the measure is robust then some data mis-preperation should not lead to significantly different results
2. This is a measurement of systematic risk and therefore it should still be captured within equities even with this altered dataset
3. The motivation of this repo is to build the statistic, although real quant work is more data prep & clean and less modelling this repo is an example of methodology

## Methodology

Using a lookback window of $T$ and decomposing a dataset of $N$ securities into $n$ principal components Kritzman, Li, Page & Rigobon (2010) define absorption ratio as

$$
\begin{equation}
AR = \frac{\sum_{i = 1}^n \sigma_{E,i}^2}{\sum_{j = 1}^N \sigma_{A,j}^2}
\end{equation}
$$

where $\sigma_{E,i}^2$ is the variance of the $i$-th eigenvector and $\sigma_{A,j}^2$ is the variance of the j-th asset. The absorption ratio is the measurement of $n$ eigenvectors with to the whole dataset. From a naive example the first principal component captures the maximum variation in that direction in financial terms its the most important driver of the index. Therefore with $n < N$ principal components its a measurement of the $n$ drivers of the portfolio following the index's variation. 

It should be noted that the denominator is the sum of possibly non-independent securities and should include the cross-product of the covariances. This approach isn't used in this repo but could be explored later on. 

The authors choose to set the number of components to 20% of the features. 

## Absorption Ratio Signal

Once the raw absorption ratio is obtained a signal can be generated by differencing 15d and 1yr rolling averages divided by 1yr rolling standard deviation. These lookback windows are set by the authors.

$$
\begin{equation}
\Delta AR = \frac{AR_{15d} - AR_{1y}}{\sigma_{1y}}
\end{equation}
$$

The signal can then be used defined into different regimes for asset allocation

$$
\begin{equation}
 signal = \begin{cases}
        \Delta AR \in (-1\sigma, 1 \sigma) \rightarrow \textrm{50/50 Stock Bonds}
        \\
        \Delta AR > + 1\sigma \rightarrow \textrm{100 bonds}
        \\
        \Delta AR < - 1 \sigma \rightarrow \textrm{100 equities}
        \end{cases}
\end{equation}
$$

## References
Kritzman, Mark and Li, Yuanzhen and Page, Sebastien and Rigobon, Roberto, Principal Components as a Measure of Systemic Risk (March 31, 2010). Available at SSRN: https://ssrn.com/abstract=1582687 or http://dx.doi.org/10.2139/ssrn.1582687
